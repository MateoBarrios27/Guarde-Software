<div class="space-y-6 animate-fade-in">
  
  <div class="flex flex-col md:flex-row md:items-center justify-between gap-4 bg-white p-4 rounded-xl shadow-sm border border-gray-200">
    <div>
      <h1 class="text-2xl font-bold text-gray-900">Estadísticas Financieras</h1>
      <p class="text-gray-500 text-sm">Métricas del mes de {{ monthName | titlecase }}.</p>
    </div>
    
    <div class="flex items-center bg-gray-50 rounded-lg p-1 border border-gray-200">
      <button (click)="prevMonth()" [disabled]="isLoading" class="p-2 flex items-center justify-center hover:bg-white hover:shadow-sm rounded-md transition-all text-gray-600 disabled:opacity-50">
        <app-icon name="chevron-left" class="h-5 w-5"></app-icon>
      </button>
      <div class="px-6 py-1 min-w-[180px] text-center font-semibold text-gray-800 capitalize">
        {{ monthName }}
      </div>
      <button (click)="nextMonth()" [disabled]="isLoading" class="p-2 flex items-center justify-center hover:bg-white hover:shadow-sm rounded-md transition-all text-gray-600 disabled:opacity-50">
        <app-icon name="chevron-right" class="h-5 w-5"></app-icon>
      </button>
    </div>
  </div>

  <div *ngIf="isLoading" class="flex justify-center py-12">
    <app-icon name="loader" class="h-10 w-10 text-blue-600 animate-spin"></app-icon>
  </div>

  <div *ngIf="!isLoading" class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 xl:grid-cols-5 gap-4">
    
    <div class="bg-white p-5 rounded-xl border border-gray-100 shadow-sm hover:shadow-md transition-shadow relative overflow-hidden">
      <div class="absolute right-0 top-0 p-4 opacity-10"><app-icon name="check-circle" class="h-16 w-16 text-green-600"></app-icon></div>
      <p class="text-sm font-medium text-gray-500 uppercase tracking-wider">Ingresos</p>
      <div class="mt-2"><span class="text-2xl font-bold text-green-600">{{ stats.totalPagado | currency:'ARS':'symbol-narrow':'1.0-0' }}</span></div>
      <p class="text-xs text-green-600 mt-2 font-medium">Ingresos reales recibidos</p>
    </div>

    <div class="bg-white p-5 rounded-xl border border-gray-100 shadow-sm hover:shadow-md transition-shadow relative overflow-hidden">
      <div class="absolute right-0 top-0 p-4 opacity-10"><app-icon name="file-text" class="h-16 w-16 text-blue-600"></app-icon></div>
      <p class="text-sm font-medium text-gray-500 uppercase tracking-wider">Abono</p>
      <div class="mt-2"><span class="text-2xl font-bold text-blue-900">{{ stats.totalAlquileres | currency:'ARS':'symbol-narrow':'1.0-0' }}</span></div>
      <p class="text-xs text-blue-600 mt-2 font-medium">Sumatoria de los alquileres</p>
    </div>

    <div class="bg-white p-5 rounded-xl border border-gray-100 shadow-sm hover:shadow-md transition-shadow relative overflow-hidden">
      <div class="absolute right-0 top-0 p-4 opacity-10"><app-icon name="percent" class="h-16 w-16 text-purple-600"></app-icon></div>
      <p class="text-sm font-medium text-gray-500 uppercase tracking-wider">Intereses (Mes)</p>
      <div class="mt-2"><span class="text-2xl font-bold text-purple-700">{{ stats.totalIntereses | currency:'ARS':'symbol-narrow':'1.0-0' }}</span></div>
      <p class="text-xs text-purple-600 mt-2 font-medium">Intereses aplicados</p>
    </div>

    <div class="bg-white p-5 rounded-xl border border-gray-100 shadow-sm hover:shadow-md transition-shadow relative overflow-hidden">
      <div class="absolute right-0 top-0 p-4 opacity-10"><app-icon name="trending-up" class="h-16 w-16 text-orange-600"></app-icon></div>
      <p class="text-sm font-medium text-gray-500 uppercase tracking-wider">Saldo Ant. + Alquiler</p>
      <div class="mt-2"><span class="text-2xl font-bold text-orange-700">{{ stats.deudaTotalDelMes | currency:'ARS':'symbol-narrow':'1.0-0' }}</span></div>
      <p class="text-xs text-orange-600 mt-2 font-medium">Carga total del periodo</p>
    </div>

    <div class="bg-white p-5 rounded-xl border border-gray-100 shadow-sm hover:shadow-md transition-shadow relative overflow-hidden">
      <div class="absolute right-0 top-0 p-4 opacity-10"><app-icon name="wallet" class="h-16 w-16 text-red-600"></app-icon></div>
      <p class="text-sm font-medium text-gray-500 uppercase tracking-wider">Suma Balances (Hoy)</p>
      <div class="mt-2"><span class="text-2xl font-bold text-red-700">{{ stats.balanceGlobalActual | currency:'ARS':'symbol-narrow':'1.0-0' }}</span></div>
      <p class="text-xs text-red-600 mt-2 font-medium">Deuda total en la calle</p>
    </div>

    <!-- 5. ESPACIOS OCUPADOS (NUEVO - GLOBAL) -->
    <div class="bg-white p-5 rounded-xl border border-gray-100 shadow-sm hover:shadow-md transition-shadow relative overflow-hidden group">
      <div class="absolute right-0 top-0 p-4 opacity-10 group-hover:opacity-20 transition-opacity">
        <app-icon name="package" class="h-16 w-16 text-orange-600"></app-icon>
      </div>
      <p class="text-sm font-medium text-gray-500 uppercase tracking-wider">Espacios Ocupados</p>
      <div class="mt-2 flex items-baseline gap-1">
        <span class="text-3xl font-bold text-orange-700">{{ stats.totalEspaciosOcupados }}</span>
        <span class="text-sm text-gray-500 font-medium">unidades</span>
      </div>
      <p class="text-xs text-orange-600 mt-2 font-medium">Total histórico activo</p>
    </div>

  </div>
</div>