<div class="space-y-6">
  <!-- Header -->
  <div class="mb-6 mt-0">
    <h1 class="text-2xl text-gray-900 mb-2">Gestiona usuarios y configuraciones del sistema</h1>
  </div>

  <div class="grid grid-cols-12 gap-6">
    <!-- Sidebar -->
    <div class="col-span-12 lg:col-span-3">
      <div class="border rounded-lg shadow bg-white">
        <div class="p-4 font-semibold border-b flex items-center gap-2 text-gray-700 text-sm">
          Configuraciones
        </div>
        <nav>
            <button
                *ngFor="let section of configSections"
                (click)="setActive(section.id)"
                class="w-full flex items-center gap-3 px-4 py-3 text-left transition-colors focus:outline-none"
                [ngClass]="activeSection === section.id
                    ? 'text-blue-700 bg-blue-50 border-r-2 border-blue-600 font-medium'
                    : 'text-gray-600 hover:bg-gray-50 border-r-0'">
                <span>{{ section.title }}</span>
            </button>
        </nav>
      </div>
    </div>

    <!-- Contenido principal -->
    <div class="col-span-12 lg:col-span-9">
      <!-- Sección Usuarios -->
      <div *ngIf="activeSection === 'usuarios'" class="border rounded-lg shadow bg-white">
        <div class="p-4 flex justify-between items-center border-b">
          <div class="font-semibold flex items-center gap-2 text-gray-700">
            Gestión de Usuarios
          </div>
          <button class="px-3 py-1 rounded bg-blue-600 text-white text-sm hover:bg-blue-700"
          (click)="openCreateUserModal()">
            + Nuevo Usuario
          </button>
        </div>
        <div class="p-4 overflow-x-auto">
          <table class="min-w-full border text-sm">
            <thead class="bg-gray-100 text-gray-600">
              <tr>
                <th class="px-4 py-2 text-left">Usuario</th>
                <th class="px-4 py-2 text-left">Tipo</th>
                <th class="px-4 py-2 text-left">Nombre</th>
                <th class="px-4 py-2 text-left">Apellido</th>
                <th class="px-4 py-2 text-left">Acciones</th>
              </tr>
            </thead>
            <tbody>
              <tr *ngFor="let user of users">
                <td class="px-4 py-2">{{user.userName}}</td>
                <td class="px-4 py-2">{{getUserTypeName(user.userTypeId)}}</td>
                <td class="px-4 py-2">{{user.firstName}}</td>
                <td class="px-4 py-2">{{user.lastName}}</td>     
                <td class="px-4 py-2 flex gap-2">
                  <button class="px-2 py-1 border rounded text-xs" (click)="openEditModalModal(user)" >Editar</button>
                  <button class="px-2 py-1 border rounded text-xs text-red-600" (click)="deleteUser(user.id)">Eliminar</button>
                </td>
              </tr>
            </tbody>
          </table>
        </div>
      </div>

      <div class="space-y-6" *ngIf="activeSection === 'smtp'">
  
      <div class="flex justify-between items-center border-b pb-4">
        <div>
          <h2 class="text-xl font-bold text-gray-800">Servidores de Correo (SMTP)</h2>
          <p class="text-sm text-gray-500">Gestiona las cuentas para el envío de comunicados</p>
        </div>
        <button (click)="openModal()" class="bg-blue-600 hover:bg-blue-700 text-white px-4 py-2 rounded-lg flex items-center gap-2">
          <app-icon name="plus" class="w-4 h-4"></app-icon>
          Nuevo Servidor
        </button>
      </div>

      <div class="grid gap-4 md:grid-cols-2 lg:grid-cols-3">
        @for (smtp of smtpConfigs(); track smtp.id) {
          <div class="bg-white p-5 rounded-xl border border-gray-200 shadow-sm hover:shadow-md transition">
            <div class="flex justify-between items-start mb-3">
              <div class="flex items-center gap-2">
                <div class="p-2 bg-blue-50 text-blue-600 rounded-lg">
                    <app-icon name="mail" class="w-5 h-5"></app-icon>
                </div>
                <h3 class="font-bold text-gray-800">{{ smtp.name }}</h3>
              </div>
              <div class="flex gap-1">
                <button (click)="openModal(smtp)" class="p-1.5 text-gray-500 hover:bg-gray-100 rounded-lg">
                  <app-icon name="edit" class="w-4 h-4"></app-icon>
                </button>
                <button (click)="deleteConfig(smtp.id!)" class="p-1.5 text-red-500 hover:bg-red-50 rounded-lg">
                  <app-icon name="trash" class="w-4 h-4"></app-icon>
                </button>
              </div>
            </div>
            
            <div class="text-sm text-gray-600 space-y-1">
              <p><strong>Host:</strong> {{ smtp.host }}:{{ smtp.port }}</p>
              <p><strong>User:</strong> {{ smtp.email }}</p>
              <div class="flex items-center gap-2 mt-2">
                <span *ngIf="smtp.useSsl" class="px-2 py-0.5 bg-green-100 text-green-700 text-xs rounded-full">SSL Activado</span>
                <span *ngIf="smtp.enableBcc" class="px-2 py-0.5 bg-purple-100 text-purple-700 text-xs rounded-full" title="{{smtp.bccEmail}}">Copia Oculta ON</span>
              </div>
            </div>
          </div>
        }
      </div>
    </div>

    @if (isModalOpen()) {
      <div class="fixed inset-0 bg-black/50 z-50 flex items-center justify-center p-4 backdrop-blur-sm">
        <div class="bg-white rounded-xl shadow-2xl w-full max-w-lg overflow-hidden">
          <div class="p-4 border-b bg-gray-50 flex justify-between items-center">
            <h3 class="font-bold text-lg text-gray-800">
              {{ currentConfig().id ? 'Editar Servidor' : 'Nuevo Servidor SMTP' }}
            </h3>
            <button (click)="closeModal()" class="text-gray-400 hover:text-gray-600">
              <app-icon name="x" class="w-5 h-5"></app-icon>
            </button>
          </div>
          
          <div class="p-6 space-y-4 max-h-[70vh] overflow-y-auto">
            
            <div>
              <label class="block text-sm font-medium text-gray-700 mb-1">Nombre (Alias)</label>
              <input [(ngModel)]="currentConfig().name" type="text" placeholder="Ej: Donweb Marketing" class="w-full p-2 border rounded-lg focus:ring-2 focus:ring-blue-500 outline-none">
            </div>

            <div class="grid grid-cols-3 gap-4">
              <div class="col-span-2">
                <label class="block text-sm font-medium text-gray-700 mb-1">Host SMTP</label>
                <input [(ngModel)]="currentConfig().host" type="text" placeholder="smtp.ejemplo.com" class="w-full p-2 border rounded-lg">
              </div>
              <div>
                <label class="block text-sm font-medium text-gray-700 mb-1">Puerto</label>
                <input [(ngModel)]="currentConfig().port" type="number" class="w-full p-2 border rounded-lg">
              </div>
            </div>

            <div>
              <label class="block text-sm font-medium text-gray-700 mb-1">Usuario / Email</label>
              <input [(ngModel)]="currentConfig().email" type="email" class="w-full p-2 border rounded-lg">
            </div>

            <div>
              <label class="block text-sm font-medium text-gray-700 mb-1">Contraseña</label>
              <input [(ngModel)]="currentConfig().password" type="password" class="w-full p-2 border rounded-lg">
            </div>

            <div class="flex items-center gap-2 py-2">
              <input [(ngModel)]="currentConfig().useSsl" type="checkbox" id="ssl" class="w-4 h-4 text-blue-600 rounded">
              <label for="ssl" class="text-sm text-gray-700">Usar SSL/TLS</label>
            </div>

            <div class="bg-purple-50 p-4 rounded-lg border border-purple-100">
              <div class="flex items-center gap-2 mb-2">
                  <input [(ngModel)]="currentConfig().enableBcc" type="checkbox" id="bcc" class="w-4 h-4 text-purple-600 rounded">
                  <label for="bcc" class="font-bold text-sm text-purple-800">Enviar copia de respaldo (Auditoría)</label>
              </div>
              
              @if (currentConfig().enableBcc) {
                <label class="block text-xs font-medium text-gray-600 mb-1">Email destino de la copia:</label>
                <input [(ngModel)]="currentConfig().bccEmail" type="email" class="w-full p-2 border border-purple-200 rounded-lg bg-white">
                <p class="text-xs text-gray-500 mt-1">Se enviará una copia oculta a este mail por cada comunicado enviado.</p>
              }
            </div>

          </div>

          <div class="p-4 border-t bg-gray-50 flex justify-end gap-2">
            <button (click)="closeModal()" class="px-4 py-2 text-gray-600 hover:bg-gray-100 rounded-lg">Cancelar</button>
            <button (click)="saveConfig()" class="px-6 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 shadow-sm">
              Guardar Servidor
            </button>
          </div>
        </div>
      </div>
    }

      <!-- Medios de pago -->
      <div *ngIf="activeSection === 'medios-pago'" class="border rounded-lg shadow bg-white">
        <div class="p-4 flex justify-between items-center border-b">
          <div class="font-semibold flex items-center gap-2 text-gray-700">
            Medios de Pago
          </div>
           <button class="px-3 py-1 rounded bg-blue-600 text-white text-sm hover:bg-blue-700"
            (click)="openCreatePaymentMethod()">
              + Nuevo Metodo de pago
          </button>
        </div>
        <div class="p-4 overflow-x-auto">
          <table class="min-w-full border text-sm">
            <thead class="bg-gray-100 text-gray-600">
              <tr>
                <th class="px-4 py-2 text-left">Nombre</th>
                <th class="px-4 py-2 text-left">Comisión</th>
                <th class="px-4 py-2 text-left">Acciones</th>
              </tr>
            </thead>
            <tbody>
              <tr *ngFor="let paymentmeth of paymentMethods">
                <td class="px-4 py-2">{{paymentmeth.name}}</td>
                <td class="px-4 py-2">{{paymentmeth.commission}} %</td>
                <td class="px-4 py-2 flex gap-2">
                  <button class="px-2 py-1 border rounded text-xs" (click)="openUpdatePaymentModal(paymentmeth)">Editar</button>
                  <button class="px-2 py-1 border rounded text-xs text-red-600" (click)="deletePaymentMethod(paymentmeth.id)">Eliminar</button>
                  
                </td>
              </tr>
            </tbody>
          </table>
        </div>
      </div>

      <div *ngIf="activeSection === 'facturacion'" class="border rounded-lg shadow bg-white">
        <div class="p-4 flex justify-between items-center border-b">
          <div class="font-semibold flex items-center gap-2 text-gray-700">
            Tipos de Factura
          </div>
          <button class="px-3 py-1 rounded bg-blue-600 text-white text-sm hover:bg-blue-700"
            (click)="openCreateBillingTypeModal()">
            + Nuevo Tipo de Factura
          </button>
        </div>
        <div class="p-4 overflow-x-auto">
          <table class="min-w-full border text-sm">
            <thead class="bg-gray-100 text-gray-600">
              <tr>
                <th class="px-4 py-2 text-left">ID</th>
                <th class="px-4 py-2 text-left">Nombre</th>
                <th class="px-4 py-2 text-left">Acciones</th>
              </tr>
            </thead>
            <tbody>
              <tr *ngIf="billingTypes.length === 0">
                <td colspan="3" class="px-4 py-4 text-center text-gray-500">
                  No hay tipos de factura definidos.
                </td>
              </tr>
              <tr *ngFor="let bt of billingTypes">
                <td class="px-4 py-2 w-20">{{ bt.id }}</td>
                <td class="px-4 py-2 font-medium">{{ bt.name }}</td>
                <td class="px-4 py-2 flex gap-2 w-40">
                  <button class="px-2 py-1 border rounded text-xs" (click)="openEditBillingTypeModal(bt)">
                    Editar
                  </button>
                  <button class="px-2 py-1 border rounded text-xs text-red-600" (click)="deleteBillingType(bt)">
                    Eliminar
                  </button>
                </td>
              </tr>
            </tbody>
          </table>
        </div>
      </div>

      <div *ngIf="activeSection === 'aumentos'" class="border rounded-lg shadow bg-white">
        <div class="p-4 flex justify-between items-center border-b">
          <div class="font-semibold flex items-center gap-2 text-gray-700">
            Gestión de Aumentos Mensuales
          </div>
          <button class="px-3 py-1 rounded bg-blue-600 text-white text-sm hover:bg-blue-700"
            (click)="openCreateIncreaseModal()">
            + Nuevo Aumento
          </button>
        </div>
        <div class="p-4 overflow-x-auto">
          <p class="text-sm text-gray-600 mb-4">
            Define el porcentaje de aumento que se aplicará a los clientes en su mes de aniversario.
            El job de aumentos usará el valor del mes correspondiente.
          </p>
          <table class="min-w-full border text-sm">
            <thead class="bg-gray-100 text-gray-600">
              <tr>
                <th class="px-4 py-2 text-left">Mes de Aplicación</th>
                <th class="px-4 py-2 text-left">Porcentaje</th>
                <th class="px-4 py-2 text-left">Acciones</th>
              </tr>
            </thead>
            <tbody>
              <tr *ngIf="monthlyIncreases.length === 0">
                <td colspan="3" class="px-4 py-4 text-center text-gray-500">
                  No hay aumentos programados.
                </td>
              </tr>
              <tr *ngFor="let inc of monthlyIncreases">
                <td class="px-4 py-2 font-medium">{{ formatDateToMonthYear(inc.effectiveDate) }}</td>
                <td class="px-4 py-2 font-semibold text-red-600">{{ inc.percentage | number:'1.2-2' }} %</td>
                <td class="px-4 py-2 flex gap-2 w-40">
                  <button class="px-2 py-1 border rounded text-xs" (click)="openEditIncreaseModal(inc)">
                    Editar
                  </button>
                  <button class="px-2 py-1 border rounded text-xs text-red-600" (click)="deleteIncrease(inc)">
                    Eliminar
                  </button>
                </td>
              </tr>
            </tbody>
          </table>
        </div>
          <div *ngIf="showCreateIncreaseModal"
        class="fixed inset-0 z-50 flex items-center justify-center p-4 bg-black/50"
        (keydown.escape)="closeCreateIncreaseModal()"
        tabindex="-1">
      <div class="w-full max-w-lg bg-white rounded-2xl shadow-2xl p-6 relative animate-fadeIn"
          (click)="$event.stopPropagation()">

        <div class="flex items-center justify-between border-b pb-3 mb-5">
          <div class="flex items-center gap-2">
            <app-icon name="trending-up" class="h-6 w-6 text-blue-600"></app-icon>
            <h3 class="text-xl font-semibold text-gray-800">Programar Aumento Mensual</h3>
          </div>
          <button type="button" (click)="closeCreateIncreaseModal()" class="text-gray-400 hover:text-gray-600 text-2xl leading-none">×</button>
        </div>

        <div class="space-y-4">
          <div>
            <label class="block text-sm text-gray-600 mb-1 font-medium">Mes y Año de Aplicación</label>
            <input type="month"
                  [(ngModel)]="newIncrease.effectiveDate"
                  class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-400 focus:outline-none text-gray-700"/>
            <p class="text-xs text-gray-500 mt-1">El aumento se aplicará a los clientes cuyo aniversario sea en este mes.</p>
          </div>
          <div>
            <label class="block text-sm text-gray-600 mb-1 font-medium">Porcentaje de Aumento (%)</label>
            <input type="number"
                  [(ngModel)]="newIncrease.percentage"
                  (keydown.enter)="saveNewIncrease()"
                  class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-400 focus:outline-none text-gray-700"
                  placeholder="Ej: 25.5"/>
          </div>
        </div>

        <div class="mt-6 flex justify-end gap-3 border-t pt-4">
          <button type="button" (click)="closeCreateIncreaseModal()" class="px-4 py-2 rounded-lg border text-gray-600 hover:bg-gray-200">
            Cancelar
          </button>
          <button type="button" (click)="saveNewIncrease()" class="px-4 py-2 rounded-lg bg-blue-600 text-white font-medium hover:bg-blue-700">
            Guardar Aumento
          </button>
        </div>
      </div>
    </div>

    <!-- MODAL EDITAR AUMENTO -->
    <div *ngIf="showEditIncreaseModal"
        class="fixed inset-0 z-50 flex items-center justify-center p-4 bg-black/50"
        (keydown.escape)="closeEditIncreaseModal()"
        tabindex="-1">
      <div class="w-full max-w-lg bg-white rounded-2xl shadow-2xl p-6 relative animate-fadeIn"
          (click)="$event.stopPropagation()">

        <div class="flex items-center justify-between border-b pb-3 mb-5">
          <div class="flex items-center gap-2">
            <app-icon name="edit" class="h-6 w-6 text-blue-600"></app-icon>
            <h3 class="text-xl font-semibold text-gray-800">Editar Aumento</h3>
          </div>
          <button type="button" (click)="closeEditIncreaseModal()" class="text-gray-400 hover:text-gray-600 text-2xl leading-none">×</button>
        </div>

        <div class="space-y-4">
          <div>
            <label class="block text-sm text-gray-600 mb-1 font-medium">Mes de Aplicación</label>
            <input type="text"
                  [value]="formatDateToMonthYear(editingIncrease.effectiveDate)"
                  disabled
                  class="w-full px-3 py-2 border border-gray-300 rounded-lg bg-gray-100 text-gray-500"/>
          </div>
          <div>
            <label class="block text-sm text-gray-600 mb-1 font-medium">Porcentaje de Aumento (%)</label>
            <input type="number"
                  [(ngModel)]="editingIncrease.percentage"
                  (keydown.enter)="saveUpdatedIncrease()"
                  class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-400 focus:outline-none text-gray-700"
                  placeholder="Ej: 25.5"/>
          </div>
        </div>

        <div class="mt-6 flex justify-end gap-3 border-t pt-4">
          <button type="button" (click)="closeEditIncreaseModal()" class="px-4 py-2 rounded-lg border text-gray-600 hover:bg-gray-200">
            Cancelar
          </button>
          <button type="button" (click)="saveUpdatedIncrease()" class="px-4 py-2 rounded-lg bg-blue-600 text-white font-medium hover:bg-blue-700">
            Actualizar
          </button>
        </div>
      </div>
    </div>
      </div>

      <!-- Sección Datos -->
      <div *ngIf="activeSection === 'datos'" class="border rounded-lg shadow bg-white">
        <div class="p-4 border-b font-semibold text-gray-700">Datos de la Empresa</div>
        <div class="p-4 space-y-4">
          <div class="grid grid-cols-2 gap-4">
            <div>
              <label class="block text-sm font-medium">Nombre Empresa</label>
              <input type="text" class="w-full border rounded px-3 py-2" placeholder="GuardeSoftware"/>
            </div>
            <div>
              <label class="block text-sm font-medium">CUIT</label>
              <input type="text" class="w-full border rounded px-3 py-2" placeholder="20-12345678-9"/>
            </div>
          </div>
          <div>
            <label class="block text-sm font-medium">Dirección</label>
            <input type="text" class="w-full border rounded px-3 py-2" placeholder="Av. Principal 1234"/>
          </div>
          <div>
            <label class="block text-sm font-medium">Teléfono</label>
            <input type="text" class="w-full border rounded px-3 py-2" placeholder="+54 11 1234-5678"/>
          </div>
        </div>
      </div>
    </div>
  </div>
  
</div>
<div *ngIf="showCreateBillingTypeModal"
       class="fixed inset-0 z-50 flex items-center justify-center p-4 bg-black/50"
       (keydown.escape)="closeCreateBillingTypeModal()"
       tabindex="-1">
    <div class="w-full max-w-lg bg-white rounded-2xl shadow-2xl p-6 relative animate-fadeIn"
         (click)="$event.stopPropagation()">

      <div class="flex items-center justify-between border-b pb-3 mb-5">
        <div class="flex items-center gap-2">
          <app-icon name="file-plus" class="h-6 w-6 text-blue-600"></app-icon>
          <h3 class="text-xl font-semibold text-gray-800">Crear Tipo de Factura</h3>
        </div>
        <button type="button" (click)="closeCreateBillingTypeModal()" class="text-gray-400 hover:text-gray-600 text-2xl leading-none">×</button>
      </div>

      <div class="space-y-4">
        <div>
          <label class="block text-sm text-gray-600 mb-1 font-medium">Nombre</label>
          <input type="text"
                 [(ngModel)]="newBillingType.name"
                 (keydown.enter)="saveNewBillingType()"
                 class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-400 focus:outline-none text-gray-700"
                 placeholder="Ej: Factura A"/>
        </div>
      </div>

      <div class="mt-6 flex justify-end gap-3 border-t pt-4">
        <button type="button" (click)="closeCreateBillingTypeModal()" class="px-4 py-2 rounded-lg border text-gray-600 hover:bg-gray-200">
          Cancelar
        </button>
        <button type="button" (click)="saveNewBillingType()" class="px-4 py-2 rounded-lg bg-blue-600 text-white font-medium hover:bg-blue-700">
          Crear
        </button>
      </div>
    </div>
  </div>

  <div *ngIf="showEditBillingTypeModal"
       class="fixed inset-0 z-50 flex items-center justify-center p-4 bg-black/50"
       (keydown.escape)="closeEditBillingTypeModal()"
       tabindex="-1">
    <div class="w-full max-w-lg bg-white rounded-2xl shadow-2xl p-6 relative animate-fadeIn"
         (click)="$event.stopPropagation()">

      <div class="flex items-center justify-between border-b pb-3 mb-5">
        <div class="flex items-center gap-2">
          <app-icon name="file-text" class="h-6 w-6 text-blue-600"></app-icon>
          <h3 class="text-xl font-semibold text-gray-800">Editar Tipo de Factura</h3>
        </div>
        <button type="button" (click)="closeEditBillingTypeModal()" class="text-gray-400 hover:text-gray-600 text-2xl leading-none">×</button>
      </div>

      <div class="space-y-4">
        <div>
          <label class="block text-sm text-gray-600 mb-1 font-medium">ID</label>
          <input type="text"
                 [value]="editingBillingType.id"
                 disabled
                 class="w-full px-3 py-2 border border-gray-300 rounded-lg bg-gray-100 text-gray-500"/>
        </div>
        <div>
          <label class="block text-sm text-gray-600 mb-1 font-medium">Nombre</label>
          <input type="text"
                 [(ngModel)]="editingBillingType.name"
                 (keydown.enter)="saveUpdatedBillingType()"
                 class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-400 focus:outline-none text-gray-700"
                 placeholder="Ej: Factura A"/>
        </div>
      </div>

      <div class="mt-6 flex justify-end gap-3 border-t pt-4">
        <button type="button" (click)="closeEditBillingTypeModal()" class="px-4 py-2 rounded-lg border text-gray-600 hover:bg-gray-200">
          Cancelar
        </button>
        <button type="button" (click)="saveUpdatedBillingType()" class="px-4 py-2 rounded-lg bg-blue-600 text-white font-medium hover:bg-blue-700">
          Actualizar
        </button>
      </div>
    </div>
  </div>
  

<div *ngIf="showCreateUserModal"
     class="fixed inset-0 z-50 flex items-center justify-center p-4 bg-black/50"
     (keydown.escape)="closeCreateUserModal()"
     tabindex="-1">

  <div class="w-full max-w-lg bg-white rounded-2xl shadow-2xl p-6 relative animate-fadeIn"
       (click)="$event.stopPropagation()">

    <!-- Header -->
    <div class="flex items-center justify-between border-b pb-3 mb-5">
      <div class="flex items-center gap-2">
        <app-icon name="user-plus" class="h-6 w-6 text-blue-600"></app-icon>
        <h3 class="text-xl font-semibold text-gray-800">Registrar nuevo usuario</h3>
      </div>
      <button type="button"
              (click)="closeCreateUserModal()"
              class="text-gray-400 hover:text-gray-600 text-2xl leading-none">×</button>
    </div>

    <!-- Body -->
    <div class="space-y-5">
      
      <!-- Datos personales -->
      <div>
        <h4 class="text-sm font-semibold text-gray-500 uppercase mb-2">Datos personales</h4>
        <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
          <div>
            <label class="block text-sm text-gray-600 mb-1 font-medium">Nombre</label>
            <input type="text"
                   [(ngModel)]="userCreated.firstName"
                   class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-400 focus:outline-none text-gray-700"
                   placeholder="Ej: Augusto" />
          </div>

          <div>
            <label class="block text-sm text-gray-600 mb-1 font-medium">Apellido</label>
            <input type="text"
                   [(ngModel)]="userCreated.lastName"
                   class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-400 focus:outline-none text-gray-700"
                   placeholder="Ej: palasTANGA" />
          </div>
        </div>
      </div>

      <!-- Datos de acceso -->
      <div>
        <h4 class="text-sm font-semibold text-gray-500 uppercase mb-2">Datos de acceso</h4>
        <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
          <div>
            <label class="block text-sm text-gray-600 mb-1 font-medium">Nombre de usuario</label>
            <input type="text"
                   [(ngModel)]="userCreated.userName"
                   class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-400 focus:outline-none text-gray-700"
                   placeholder="Ej: chinitoo12" />
          </div>

          <div>
            <label class="block text-sm text-gray-600 mb-1 font-medium">Contraseña</label>
            <input type="password"
                   [(ngModel)]="userCreated.password"
                   class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-400 focus:outline-none text-gray-700"
                   placeholder="********" />
          </div>
        </div>
      </div>

      <!-- Rol / permisos -->
      <div>
        <h4 class="text-sm font-semibold text-gray-500 uppercase mb-2">Rol de usuario</h4>
        <div class="flex items-center border border-gray-300 rounded-lg overflow-hidden bg-white focus-within:ring-2 focus-within:ring-blue-400">
          <select [(ngModel)]="userCreated.userTypeId"
                  class="w-full px-3 py-2 text-gray-700 focus:outline-none bg-white">
            <option *ngFor="let usertype of userTypes" [value]="usertype.id">{{ usertype.name }}</option>
          </select>
        </div>
      </div>
    </div>

    <!-- Footer -->
    <div class="mt-6 flex justify-end gap-3 border-t pt-4">
      <button type="button"
              (click)="closeCreateUserModal()"
              class="px-4 py-2 rounded-lg border text-gray-600 hover:bg-gray-200">
        Cancelar
      </button>
      <button type="button"
              (click)="saveCreateUser(userCreated)"
              class="px-4 py-2 rounded-lg bg-blue-600 text-white font-medium hover:bg-blue-700">
        Crear usuario
      </button>
    </div>

  </div>
</div>


 
  <!-- EDIT USER MODAL-->
<div *ngIf="showEditUserModal"
     class="fixed inset-0 z-50 flex items-center justify-center p-4 bg-black/50"
     (keydown.escape)="closeEditUserModal()"
     tabindex="-1">

  <div class="w-full max-w-lg bg-white rounded-2xl shadow-2xl p-6 relative animate-fadeIn"
       (click)="$event.stopPropagation()">

    <!-- Header -->
    <div class="flex items-center justify-between border-b pb-3 mb-5">
      <div class="flex items-center gap-2">
        <app-icon name="user-plus" class="h-6 w-6 text-blue-600"></app-icon>
        <h3 class="text-xl font-semibold text-gray-800">Editar usuario</h3>
      </div>
      <button type="button"
              (click)="closeEditUserModal()"
              class="text-gray-400 hover:text-gray-600 text-2xl leading-none">×</button>
    </div>

    <!-- Body -->
    <div class="space-y-5">
      
      <!-- Datos personales -->
        <div>
        <h4 class="text-sm font-semibold text-gray-500 uppercase mb-2">Datos personales</h4>
        <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
          <div>
            <label class="block text-sm text-gray-600 mb-1 font-medium">Nombre</label>
            <input type="text"
                   [(ngModel)]="userEdit.firstName"
                   class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-400 focus:outline-none text-gray-700"/>
          </div>

          <div>
            <label class="block text-sm text-gray-600 mb-1 font-medium">Apellido</label>
            <input type="text"
                   [(ngModel)]="userEdit.lastName"
                   class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-400 focus:outline-none text-gray-700"/>
          </div>
        </div>
      </div>

      <!-- Datos de acceso -->
      <div>
        <h4 class="text-sm font-semibold text-gray-500 uppercase mb-2">Datos de acceso</h4>
        <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
          <div>
            <label class="block text-sm text-gray-600 mb-1 font-medium">Nombre de usuario</label>
            <input type="text"
                   [(ngModel)]="userEdit.userName"
                   class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-400 focus:outline-none text-gray-700"/>
          </div>
        </div>
      </div>

      <!-- Rol / permisos -->
      <div>
        <h4 class="text-sm font-semibold text-gray-500 uppercase mb-2">Rol de usuario</h4>
        <div class="flex items-center border border-gray-300 rounded-lg overflow-hidden bg-white focus-within:ring-2 focus-within:ring-blue-400">
          <select [(ngModel)]="userEdit.userTypeId"
                  class="w-full px-3 py-2 text-gray-700 focus:outline-none bg-white">
            <option *ngFor="let usertype of userTypes" [value]="usertype.id">{{ usertype.name }}</option>
          </select>
        </div>
      </div>
    </div>

    <!-- Footer -->
    <div class="mt-6 flex justify-end gap-3 border-t pt-4">
      <button type="button"
              (click)="closeEditUserModal()"
              class="px-4 py-2 rounded-lg border text-gray-600 hover:bg-gray-200">
        Cancelar
      </button>
      <button type="button"
              class="px-4 py-2 rounded-lg bg-blue-600 text-white font-medium hover:bg-blue-700"
              (click)="SaveUpdateUserModal(userEdit)">
        Actualizar
      </button>
    </div>

  </div>
</div>


<!-- CREATE PAYMENT METHOD MODAL -->
<div *ngIf="showCreatePaymentMethod"
     class="fixed inset-0 z-50 flex items-center justify-center p-4 bg-black/50"
     (keydown.escape)="closeCreatePaymentMethodModal()"
     tabindex="-1">

  <div class="w-full max-w-lg bg-white rounded-2xl shadow-2xl p-6 relative animate-fadeIn"
       (click)="$event.stopPropagation()">

    <!-- Header -->
    <div class="flex items-center justify-between border-b pb-3 mb-5">
      <div class="flex items-center gap-2">
        <app-icon name="plus-circle" class="h-6 w-6 text-green-600"></app-icon>
        <h3 class="text-xl font-semibold text-gray-800">Crear método de pago</h3>
      </div>
      <button type="button"
              (click)="closeCreatePaymentMethodModal()"
              class="text-gray-400 hover:text-gray-600 text-2xl leading-none">×</button>
    </div>

    <!-- Body -->
    <div class="space-y-6">
      <!-- Información general -->
      <div>
        <h4 class="text-sm font-semibold text-gray-500 uppercase mb-2">Datos del método</h4>
        <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
          <!-- Nombre -->
          <div class="md:col-span-2">
            <label class="block text-sm text-gray-600 mb-1 font-medium">Nombre del método</label>
            <input type="text"
                   [(ngModel)]="createPaymentMethodDto.name"
                   class="w-full px-3 py-2 border border-gray-300 rounded-lg text-gray-700 "
                   placeholder="Ej: Transferencia, Efectivo, Mercado Pago..." />
          </div>

          <!-- Comisión -->
          <div class="md:col-span-2">
            <label class="block text-sm text-gray-600 mb-1 font-medium">Comisión (%)</label>
            <div class="flex items-center border border-gray-300 rounded-lg overflow-hidden bg-white">
              <input type="number"
                     min="0"
                     max="100"
                     step="0.01"
                     [(ngModel)]="createPaymentMethodDto.commission"
                     class="w-full px-3 py-2 focus:outline-none text-gray-800"
                     placeholder="Ej: 1.50" />
              <span class="px-3 text-gray-500 select-none">%</span>
            </div>
            <p class="text-xs text-gray-500 mt-1">Debe ser un valor entre 0 y 100.</p>
          </div>
        </div>
      </div>
      
    </div>

    <!-- Footer -->
    <div class="mt-6 flex justify-end gap-3 border-t pt-4">
      <button type="button"
              (click)="closeCreatePaymentMethodModal()"
              class="px-4 py-2 rounded-lg border text-gray-600 hover:bg-gray-200">
        Cancelar
      </button>
      <button type="button"
              (click)="createPaymentMethod(createPaymentMethodDto)"
              class="px-4 py-2 rounded-lg bg-green-600 text-white font-medium hover:bg-green-700">
        Crear
      </button>
    </div>

  </div>
  
</div>


<!-- UPDATE PAYMENT METHOD MODAL -->
<div *ngIf="showUpdatePaymentMethodModal"
     class="fixed inset-0 z-50 flex items-center justify-center p-4 bg-black/50"
     (keydown.escape)="closeUpdatePaymentMethodModal()"
     tabindex="-1">

  <div class="w-full max-w-lg bg-white rounded-2xl shadow-2xl p-6 relative animate-fadeIn"
       (click)="$event.stopPropagation()">

    <!-- Header -->
    <div class="flex items-center justify-between border-b pb-3 mb-5">
      <div class="flex items-center gap-2">
        <app-icon name="credit-card" class="h-6 w-6 text-indigo-600"></app-icon>
        <h3 class="text-xl font-semibold text-gray-800">Editar método de pago</h3>
      </div>
      <button type="button"
              (click)="closeUpdatePaymentMethodModal()"
              class="text-gray-400 hover:text-gray-600 text-2xl leading-none">×</button>
    </div>

    <!-- Body -->
    <div class="space-y-6">

      <!-- Información general -->
      <div>
        <h4 class="text-sm font-semibold text-gray-500 uppercase mb-2">Información general</h4>
        <div class="bg-gray-50 rounded-lg px-3 py-3 text-sm text-gray-700 border flex justify-between items-center">
          <span class="font-medium text-gray-600">Método de pago:</span>
          <span class="font-semibold text-gray-600">{{ SelectedPaymentMethodName }}</span>
        </div>
      </div>

      <!-- Configuración de comisión -->
      <div>
        <h4 class="text-sm font-semibold text-gray-500 uppercase mb-2">Configuración</h4>
        <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
          <div>
            <label class="block text-sm text-gray-600 mb-1 font-medium">Comisión (%)</label>
            <div class="flex items-center border border-gray-300 rounded-lg overflow-hidden bg-white focus-within:ring-2 focus-within:ring-indigo-400">
              <input type="number"
                     min="0"
                     max="100"
                     step="0.01"
                     [(ngModel)]="paymentMethodUpdate.commission"
                     class="w-full px-3 py-2 focus:outline-none text-gray-800"
                     placeholder="Ej: 2.50" />
              <span class="px-3 text-gray-500 select-none">%</span>
        </div>
      </div>

    </div>

    <!-- Footer -->
    <div class="mt-6 flex justify-end gap-3 border-t pt-4">
      <button type="button"
              (click)="closeUpdatePaymentMethodModal()"
              class="px-4 py-2 rounded-lg border text-gray-600 hover:bg-gray-200">
        Cancelar
      </button>
      <button type="button"
              class="px-4 py-2 rounded-lg bg-blue-600 text-white font-medium hover:bg-blue-700"
              (click)="updatePaymentMethod(SelectedPaymentMethodId, paymentMethodUpdate)">
        Actualizar
      </button>
    </div>

  </div>

  
</div>





